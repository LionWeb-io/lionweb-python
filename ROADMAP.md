## Make the code more idiomatic

* Use more specific types from typing module (e.g., Dict, Set, Tuple) where appropriate
* Use TypeVar and Generic for better generic type support 
* Implement proper __all__ lists in __init__.py files to control what gets exported
* Consider using Python 3.10+ features like pattern matching where appropriate
* Use @dataclass decorators for classes that primarily hold data
* Implement more specific exception types rather than using generic exceptions
* Add more comprehensive docstrings following Google or NumPy style
* Implement proper type hints in docstrings
* Use f-strings for string formatting
